

<%# SAINTSTIR INTEGRATION W/ ISOTOPE  %>

<%
# Since we are returning the entire set for now, we can cache all generated content
cache ["saints_isotope"] do %>


  <!--// All available saints -->
  <div class="row">
    <!--// List of all available discrete filters -->
    <div id="discrete_filters" class="span4">
      <p>
        <a href="#" data-filter="*">Show All</a>
      </p>
      <% @attrib_categories.each do |category|
          #// if category code DNE in list of existing filters, the skip
          next if (!@attribs_all.has_key?(category.code))
      %>
        <p>
        <div class="btn-group">
          <a class="btn dropdown-toggle" data-toggle="dropdown" href="#"><%=category.name%><span class="caret"></span></a>
          <ul class="dropdown-menu">
            <% @attribs_all[category.code].each do |attrib| %>
              <a href="#" data-filter=".<%=attrib.code%>"><%=attrib.name%></a>
            <% end %>
          </ul>
        </div>
        </p>
      <% end %>
    </div>

    <!--// All available saints -->
    <div id="isotope_content" class="span8">
    <% @saints.each do |saint|
         disc_filters = saint.attribs.map(&:code).join(" ")
    %>
      <div class="element basic <%=disc_filters%>" data-symbol="<%=saint.symbol%>">
        <p class="number">DCTR</p>
        <h3 class="symbol"><%=saint.symbol%></h3>
        <br/>
        <p class="name"><%=saint.map_metadata_values[MetadataKey::NAME][0].value%></p>
      </div>
    <% end %>
    </div>

  </div>


  <script>

    // -- Twitter Bootstrap --
    // Dropdown Lists Initialization
    $('.dropdown-toggle').dropdown()


    // -- Isotope Plugin Initialization --
    // cache container & initialize isotope
    var $container = $('#isotope_content');
    $container.isotope({
      itemSelector: '.element'
    });

    // filter items when filter link is clicked
    $('#discrete_filters a').click(function(){
      var selector = $(this).attr('data-filter');
      $container.isotope({ filter: selector });
      return false;
    });

  </script>


<%
end
%>


